#include <bits/stdc++.h>
using namespace std;
int p10[100];
int p8[100];
int ip[100];
int ep[100];
int ss0[10][10];
int ss1[10][10];
int p4[100];

string shift(string s,int a)
{
   int i,j;
   string v="";
   for(i=0;i<s.size();i++){
    if(i>=a){
        v+=s[i];
    }
   }
   for(i=0;i<a;i++)
    v+=s[i];
   return v;
}
string key1(string s)
{
    string pten="";
    int i,j,k;
    for(i=0;i<10;i++){
        k=p10[i];
        k--;
        if(s[k]=='1')
            pten+='1';
        else{
            pten+='0';
        }
    }
    string s1="",s2="";
    for(i=0;i<10;i++){
        if(i<5){
           s1+=pten[i];
        }
        else{
            s2+=pten[i];
        }
    }
    s1=shift(s1,1);
    s2=shift(s2,1);
    string kk1=s1+s2;
    string mainkey="";
    for(i=0;i<8;i++){
        k=p8[i];
        k--;
        if(kk1[k]=='1')
            mainkey+='1';
        else{
            mainkey+='0';
        }
    }

    return mainkey;
}
string key2(string s)
{
    string pten="";
    int i,j,k;
    for(i=0;i<10;i++){
        k=p10[i];
        k--;
        if(s[k]=='1')
            pten+='1';
        else{
            pten+='0';
        }
    }
    string s1="",s2="";
    for(i=0;i<10;i++){
        if(i<5){
           s1+=pten[i];
        }
        else{
            s2+=pten[i];
        }
    }
    s1=shift(s1,1);
    s2=shift(s2,1);
    s1=shift(s1,2);
    s2=shift(s2,2);
    string kk1=s1+s2;
    string mainkey="";
    for(i=0;i<8;i++){
        k=p8[i];
        k--;
        if(kk1[k]=='1')
            mainkey+='1';
        else{
            mainkey+='0';
        }
    }

    return mainkey;
}
string binary(int n)
{
    int i;
    string s="";
    for(i=0;i<2;i++){
        if(n%2)
            s+='1';
        else
            s+='0';
        n=n/2;
    }
    reverse(s.begin(),s.end());
    return s;
}
int main()
{
    map<int,int>ipin;
    string s;
    int i,j,k,l;
    cout<<"Enter Key"<<endl;
    cin>>s;
    cout<<"P10 "<<endl;
    for(i=0;i<10;i++){
        cin>>p10[i];
    }
    cout<<"P8 "<<endl;
    for(i=0;i<8;i++){
        cin>>p8[i];
    }
    string k1=key1(s);
    string k2=key2(s);
    cout<<"Key 1"<<endl;
    cout<<k1<<endl;

    cout<<"Key 2"<<endl;
    cout<<k2<<endl;
    
    cout<<"Enter IP"<<endl;
    for(i=0;i<8;i++){
        cin>>ip[i];
        ipin[(ip[i]-1)]=i;
    }
    cout<<"Enter E/P"<<endl;
    for(i=0;i<8;i++){
        cin>>ep[i];
    }

    cout<<"Enter S0"<<endl;
    for(i=0;i<4;i++){
        for(j=0;j<4;j++){
            cin>>ss0[i][j];
        }
    }

    cout<<"Enter S1"<<endl;
    for(i=0;i<4;i++){
        for(j=0;j<4;j++){
            cin>>ss1[i][j];
        }
    }

    cout<<"Enter P4"<<endl;
     for(i=0;i<4;i++){
        cin>>p4[i];
    }
    string pt;
    cout<<"Plain Text"<<endl;
    cin>>pt;
    string ip1="",ip2="";

    for(i=0;i<8;i++){
     k=ip[i];
     k--;

     if(i<4)
        ip1+=pt[k];
     else{
        ip2+=pt[k];
     }
    }
    string exp="";
    for(i=0;i<8;i++){
        exp+=ip2[(ep[i]-1)];
    }
    string ss="",sf="";
    for(i=0;i<8;i++){
        if(exp[i]!=k1[i]){
            if(i<4){
                sf+='1';
            }
            else{
              ss+='1';
            }
        }
        else{
           if(i<4){
                sf+='0';
            }
            else{
              ss+='0';
            }
        }
    }
    int a0=0,b0=0;
    if(sf[0]=='1')
        a0+=2;
    if(sf[3]=='1')
        a0+=1;
    if(sf[1]=='1')
        b0+=2;
    if(sf[2]=='1')
        b0+=1;
    int val=ss0[a0][b0];
    string rss0=binary(val);
     int a1=0,b1=0;
    if(ss[0]=='1')
        a1+=2;
    if(ss[3]=='1')
        a1+=1;
    if(ss[1]=='1')
        b1+=2;
    if(ss[2]=='1')
        b1+=1;
    int vali=ss1[a1][b1];
    string rss1=binary(vali);
    string pc4=rss0+rss1,pm4="";
    cout<<rss0<<" "<<rss1<<endl;
    for(i=0;i<4;i++){
        pm4+=pc4[(p4[i]-1)];
    }
     string pip1="";
     for(i=0;i<4;i++){
        if(pm4[i]!=ip1[i])
            pip1+='1';
        else
             pip1+='0';
     }
     ip1=ip2;
     ip2=pip1;
     cout<<ip1<<" "<<ip2<<endl;
      string exp1="";
    for(i=0;i<8;i++){
        exp1+=ip2[(ep[i]-1)];
    }
     string ss00="",sf11="";
    for(i=0;i<8;i++){
        if(exp1[i]!=k2[i]){
            if(i<4){
                sf11+='1';
            }
            else{
              ss00+='1';
            }
        }
        else{
           if(i<4){
                sf11+='0';
            }
            else{
              ss00+='0';
            }
        }
    }

    cout<<sf11<<" "<<ss00<<endl;
    int a00=0,b00=0;
    if(sf11[0]=='1')
        a00+=2;
    if(sf11[3]=='1')
        a00+=1;
    if(sf11[1]=='1')
        b00+=2;
    if(sf11[2]=='1')
        b00+=1;
    int val1=ss0[a00][b00];
    string rss00=binary(val1);
     int a11=0,b11=0;
    if(ss00[0]=='1')
        a11+=2;
    if(ss00[3]=='1')
        a11+=1;
    if(ss00[1]=='1')
        b11+=2;
    if(ss00[2]=='1')
        b11+=1;
    int vali1=ss1[a11][b11];
    string rss11=binary(vali1);
    string pc41=rss00+rss11,pm41="";
    cout<<rss00<<" "<<rss11<<endl;
    for(i=0;i<4;i++){
        pm41+=pc41[(p4[i]-1)];
    }
     string pip11="";
     for(i=0;i<4;i++){
        if(pm41[i]!=ip1[i])
            pip11+='1';
        else
             pip11+='0';
     }
     ip1=pip11;
    
      string last=ip1+ip2;
      string answer="";
    for(i=0;i<8;i++){
     k=ipin[i];
    answer+=last[k];
    }
    cout<<"Desired Chypher Text"<<endl;
    cout<<answer<<endl;

}
